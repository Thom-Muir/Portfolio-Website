<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malware Traffic Analysis</title>
    <link rel="stylesheet" href="/styles.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>

	<div class="top-image-container">
		<img src="/images/top.png" alt="Top Image" class="top-image">
    </div>

    <div id="navbar-container"></div>



	<div class="contents-container">
		<div class="page" style="padding: 40px;">
			<div class="write-title">
				<h1 style="font-size: 36px; text-align: center;"> <b>Malware Traffic Analysis</b> </h1>
				<div class="write-body">
				<h3>Overview</h3>
					<p>
					One of the best resources I’ve come across for anyone interested in cybersecurity and network traffic analysis is <a href="https://malware-traffic-analysis.net/">malware-traffic-analysis.net</a>. This website hosts a vast collection of PCAP files containing captured traffic from compromised machines, along with exercises for those looking to sharpen their analysis skills. Studying this kind of real-world data provides valuable insight into the behaviors of different types of malware, from info stealers to botnets and worms.
					</p>
					<h3>Analysis Environment</h3>
					<p>
					Handling live malware samples, even passively through packet capture (PCAP) analysis, requires a secure and isolated environment. While a basic Kali Linux VM would be sufficient, I opted to leverage my <a href="/writeups/Cyberlab.html">Virtualized Cyber Lab</a> for added protection, utilizing a pfSense firewall as an additional layer of defense.
					Security is only part of the equation—having access to external security tools such as VirusTotal is equally important for analyzing artifacts. If a full cyber lab isn’t available, a host-only network setup would be a safer alternative. That said, many of the malware samples analyzed from this resource primarily target Windows systems, making my Kali Linux VM immune to direct infection.
					</p>
					<h3>Samples of Interest</h3>
					<p>
					The samples available on malware-traffic-analysis.net provide a realistic representation of modern malware trends—which, as expected, means a heavy focus on information stealers. While these are useful for research, it’s always exciting when something more unique appears.
					One such case was highlighted in the blog post: <a href="https://malware-traffic-analysis.net/2018/12/19/index.html">"Malspam Pushing the Mydoom Worm is Still a Thing"</a>. Despite being over 11 years old as of this writing, Mydoom remains active in its spamming campaign. Examining the network traffic from an infected system, we can see malicious email (malspam) spreading the worm in action.
					</p>
					<figure>
						<img src="/images/projects/mydoom.png" alt="Image of mydoom malspam">
						<figcaption>SMTP traffic from machine infected with Mydoom</figcaption>
					</figure>
					<h3>Reconstructing Malware from Network Traffic</h3>
					<p>
					While malware-traffic-analysis.net often provides direct download links for the malware samples, I prefer a more hands-on approach—reconstructing them directly from the PCAP files.
					</p>
					<p>
					In many cases, this can be as simple as using Wireshark’s "File > Export Objects" feature to retrieve transferred files.
					<p>
					Other times, extracting artifacts requires additional steps, such as decoding Base64-encoded payloads embedded in HTTP or SMTP traffic.
					</p>
					<p>
					These traffic captures not only reveal malware behavior but also provide insight into how mail servers handle spam. In the example below, an infected machine (red) attempts to deliver spam emails but encounters an SMTP blackhole server (blue), which is designed to stall the worm. By responding with a 451 temporary failure code, the server tricks the worm into retrying later, effectively wasting its time.
					</p>
					<figure>
						<img src="/images/projects/MydoomBlackHole.png" alt="exchange between mydoom infected machine and back hole SMTP server">
						<figcaption>Humorus exchange between mydoom infected machine and back hole SMTP server</figcaption>
					</figure>
			</div>
			</div>
		</div>
	</div>
	<div id="footer-container"></div>
	<script src="/scripts/collapse.js"></script>
	<script src="/scripts/navbar.js"></script>
	<script src="/scripts/footer.js"></script>
</body>
</html>